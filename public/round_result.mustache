<!DOCTYPE html>
<html lang="en">
		<head>
				<meta charset="UTF-8">
				<meta name="viewport" content="width=device-width, initial-scale=1.0">
				<title>TUM Guessr</title>
				<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
				<link rel="stylesheet" href="/style.css">
		</head>
		<body>		
				{{> header}}
				<div id="resultMapContainer">
						<div id="map"></div>
						{{^final_round}}
						<button id="continueButton">Continue</button>
						{{/final_round}}
						{{#final_round}}
						<button id="gameSummaryButton">Game Summary</button>
						{{/final_round}}
				</div>
				<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
				<script>
				 const map = L.map('map').setView([({{true_latitude}} + {{guess_latitude}}) / 2, ({{true_longitude}} + {{guess_longitude}}) / 2], 16);
				 L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
						 attribution: 'Â© OpenStreetMap contributors'
				 }).addTo(map);

				 const guessLocation = L.latLng({{guess_latitude}}, {{guess_longitude}});
				 const trueLocation = L.latLng({{true_latitude}}, {{true_longitude}});

	 			 var greenIcon = L.icon({
             iconUrl: "https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",
             iconSize: [25, 41],
             iconAnchor: [12, 41],
             popupAnchor: [1, -34]
         });

         var blueIcon = L.icon({
             iconUrl: "https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png",
             iconSize: [25, 41],
             iconAnchor: [12, 41],
             popupAnchor: [1, -34]
         });

         // Add markers to the map
         L.marker(guessLocation, {icon: blueIcon}).addTo(map).bindPopup("Guess Location");
         L.marker(trueLocation, {icon: greenIcon}).addTo(map).bindPopup("True Location");

         // Draw a dotted line between the markers
         var dottedLine = L.polyline([guessLocation, trueLocation], {
             color: "black",
             weight: 2,
             dashArray: "5, 10"
         }).addTo(map);

				 {{^final_round}}
				 const continueButton = document.getElementById("continueButton");
				 continueButton.addEventListener("click", function() {
						 window.location.replace("/game");
				 });
			   {{/final_round}}

			   {{#final_round}}
				 const gameSummaryButton = document.getElementById("gameSummaryButton");
				 gameSummaryButton.addEventListener("click", function () {
				     window.location.replace("/game/summary")
				 })
			   {{/final_round}}
				</script>
		</body>
</html>
